# Projector Warp System

360°スクリーン＋複数プロジェクター＋凸面鏡構成で、PC画面を歪み補正して自然に投影する Python ベースのプロジェクションシステムです。

---

## 🎯 概要

* 複数プロジェクターに対応（任意台数）
* 凸面鏡を介した 360° スクリーン投影
* 各スクリーンごとの歪み補正（射影変換 or 自由変形）
* 初期グリッド自動生成・GUI編集対応
* 重なり部分のアルファブレンディング対応

---

## 📦 動作の流れ

1. 編集用ディスプレイを自動認識
2. 補正モード選択：`perspective` / `warp_map`
3. 各スクリーンに初期グリッドを自動生成
4. GUI でグリッド編集（マウス操作対応）
5. 編集後、自動保存
6. 補正済み画面をリアルタイムでプロジェクターに表示

> 動画やゲームなど、任意の PC ウィンドウも自然に表示可能です

---

## 🧩 ディレクトリ構成

```
Sotsuken/
│  LICENSE.txt
│  main.py                  # 起動＆UI・編集／表示操作
│  media_player_multi.py    # 各プロジェクターへの補正表示
│  percentage.py            # ピクセル使用率確認
│  README.md
│  warp_engine.py           # 歪み補正ロジック
│  
├─config
│  │  edit_profile.json
│  └─projector_profiles
│         D2_perspective_points.json
│         D2_warp_map_points.json
│         ...
│
├─editor
│     grid_editor_perspective.py
│     grid_editor_warpmap.py
│     grid_utils.py
│
└─temp                     # エディター自動終了用ロックファイル
```

---

## 🖥 使用方法

### 1. 起動

```bash
python main.py
```

### 2. 操作手順

1. 編集用ディスプレイを自動認識
2. 補正方式を選択

   * `perspective`: 射影変換による補正（4点指定）
   * `warp_map`: 外周グリッドを自由変形して補正（曲面・オーバーラップに対応）
3. 「グリッドエディター起動」でチェックしたスクリーンの編集ウィンドウを開く
4. 点をドラッグして調整、閉じると自動保存
5. 「補正表示起動」でリアルタイム投影開始

> ⚠️ 編集済みのグリッドがある場合は必ず保存後に新しいエディターを起動してください

---

## 🎮 対応コンテンツ

* Unity 360°コンテンツ
* YouTube / VLC 動画
* 任意の PC ウィンドウ（ブラウザ・ゲーム等）

---

## 🖥 ハードウェア構成（推奨）

* **PC**: Intel Core i9 / RTX 4070 Ti SUPER / DDR5 32GB / M.2 SSD 2TB
* **プロジェクター**: Optoma GT1080 x 3
* **モニター**: 1台（編集用）

---

## ⚡ GPU 利用のメリット

* GPU を利用するとリアルタイム描画が高速化
* warp 計算やアルファブレンディングも安定
* 複数ディスプレイ投影時のフレーム落ちが減少

> GPU を認識できない場合は CPU フォールバック。リアルタイム性は低下します

### 推奨 GPU

* 複数ディスプレイ・高解像度投影の場合、RTX 3070 Ti 以上

> 他アプリケーションが GPU メモリを占有していると CPU fallback になる場合があります

---

## ⚠️ 注意事項

* ポイントファイルがない場合は起動時に自動生成
* 編集後は必ずウィンドウを閉じるか、ロックファイルを削除して自動保存・終了
* 新しいグリッドエディターを開くと既存グリッドは初期化されます
* リアルタイムリマップのため、マシンスペックに依存

---

## 📄 ライセンス

Custom License

---

💡 **まとめ**

* CPU モードでも動作可能だがリアルタイム性は落ちる
* GPU 利用で安定・高速・滑らかな補正描画を実現
* 複数プロジェクターや曲面スクリーンに対応可能
